
<h1>Patient Records</h1>

<form>
  <input type="search" name="name" value="<%= @name_search %>">
  <button type="submit">Search</button>
</form>


<table class="patients">
  <thead>
    <tr>
      <th class="name">Name</th>
      <th>Number of stays</th>
      <th>Stay Dates</th>
    </tr>
  </thead>


  <% @stays.group_by(&:patient_id).each do |group| %>

    <% patient = group[1][0] %>
     <tr <% if patient.highlighted %>class="highlighted" <% end %>>
      <td>
        <%= link_to patient.name, patient_path(patient.patient_id) %>
      </td>
      <td>
        <%= patient.stays_count %>
      </td>

      <td>


        <% dates = group[1].collect do |stay| %>
          <% stay_date(stay.admission, stay.transcribed_date_of_admission).to_s + " â€“ " + stay_date(stay.discharge, stay.transcribed_date_of_discharge).to_s %>
        <% end %>

        <%= dates.join(', ') %>
      </td>


    </tr>

  <% end %>

</table>